from Crypto.Cipher import AES
import hashlib


sig1 = [
b"\xd1\x9f\x78\xbd\xea\xb0\x19\x96\x2b\x21\x06\x76\x38\x62\xc3\x7e\xe8\x78\xe8\x47\x0f\x12\x96\x5a\x55\x62\x81\xd3\x39\xf9\xdf\xab",
b"\xae\x2d\x79\x4a\x08\xad\xe9\xd9\x3c\xaa\xd2\xd2\x6b\xdf\x5b\xd8\xfc\x59\x7d\x98\xda\xb8\x61\x65\x1c\x64\xa3\x5f\xc3\x90\xcf\x46",
b"\xd7\x25\xb7\xf3\x5d\x1a\x67\xed\x93\xd3\xba\x8f\x06\xfe\x4f\xfb\x9c\xd3\xab\x72\xdd\x2b\xf3\xa3\x16\xb4\xf5\x89\x7c\x9c\xe1\xb6",
b"\xce\xfa\xd6\x71\xfc\xc6\xfe\x9b\xaa\xaf\x79\x3f\xe0\x64\x6d\x36\x44\xe3\xdc\x00\x57\x31\x8e\xca\x3d\x0d\x8e\x02\xc3\x70\x23\x84",
b"\x65\xe6\x64\xa6\x1d\x33\x13\xa7\xc0\x78\xc2\x69\x80\x66\xdb\x29\x0a\xfb\xcd\x4a\x62\x78\xe4\x06\x2a\xf5\xb2\xd9\x90\x32\xd6\xd8",
b"\x9b\xe3\x78\xf4\x51\x0c\x4b\xdc\xce\xce\x16\xb0\x31\x46\x60\x7d\xef\xaa\x3d\x4b\x14\xd2\xd4\x49\x7a\x3c\x37\x2a\x91\xdb\xc0\xf9",
b"\x74\x57\x83\x7e\xb8\xe8\xd1\x21\xaf\xc4\x3f\x53\xa7\x03\xdc\x54\x0b\x38\x99\x3f\xc0\x74\x68\x0e\x2a\xeb\x26\x66\xc1\xd1\x07\x78",
b"\x3e\x66\x7e\x4a\x5f\x21\xda\x53\x55\x7f\x8b\xa5\x5b\x09\x82\x4f\xe5\x9e\x29\x98\xea\xcc\x7b\x5f\xfe\x21\x69\x40\xea\x6d\x40\x60",
b"\x9d\x72\x7c\xf5\xb0\xf4\x3c\xfb\xfc\x08\x55\x55\x83\xc0\x37\x43\x0d\xf6\x67\x15\x22\xa9\x66\x48\x79\xd9\xea\x85\x91\x4c\xf5\xd9",
b"\x65\xf3\x03\xf9\xa0\x47\xa9\x2f\xef\x31\xc4\x20\x27\x83\x74\x1f\xf7\xf5\x88\x13\xbf\x73\x51\xce\xe8\x27\x53\xbc\xb1\xdb\x5f\xd5",
b"\xcc\xc4\x04\xf3\x44\x33\x28\xf1\xa0\x17\x37\xe4\x3b\x86\x16\x22\x24\xcd\xe4\x62\xcb\xd7\xb3\x95\xae\x89\x67\xbe\xd7\xeb\xcf\xc3",
b"\x3a\xb4\x39\xe4\x19\x82\xcd\x36\x6b\xde\xdf\x5b\xed\x2e\xa9\xf6\x0f\x54\x6d\x78\x8d\x76\xcd\x78\x25\x52\x24\x83\x20\x21\xce\xd5",
b"\xa7\xe2\x77\xc5\x97\xee\xd3\x41\xf0\x84\xc7\x2f\x41\xf0\xd9\x82\x34\x18\xab\x9d\x09\x28\xbd\xc8\xc1\x5b\x35\x02\x8f\xf7\x7d\x41",
b"\x99\x39\xcd\xb7\xdc\x45\xfc\x8f\xe6\x82\x27\xfc\xef\xc2\x27\x13\x3b\xc6\x7d\x29\x51\x45\xd4\x05\x2b\x2a\xaa\x79\x2f\x8a\x17\x7d",
b"\x01\xc0\x3a\x68\xb7\xe5\x71\x2a\x9b\x13\x50\x49\x8b\x1d\xb0\xf6\xcd\x88\x81\x93\xa2\xf6\x59\x0d\x37\x7e\x8b\xfd\xf0\x28\x9e\x81",
b"\x05\x3a\x2a\x24\xc3\x0e\xf3\xa0\x8a\x15\x06\x14\xf5\x8a\x53\x89\xdd\x2a\x96\x6f\xbe\x1d\xb8\x33\x1a\x98\x5e\x1e\x4d\x61\x87\x6d",
b"\x53\x71\xbe\xb7\xbd\x86\x87\xd6\x5f\xda\x30\xaa\xa7\x20\x81\xe0\x7e\x60\x37\xb5\x90\x11\x0b\x28\x89\x8f\x6a\x49\x54\x1e\x56\x85",
b"\x7a\x77\x9a\xb5\x02\xda\x64\x0b\x2f\x3e\x4a\x47\x74\xaa\x94\x88\xe5\x6f\x21\xad\x0e\xd6\x9b\xea\xc6\xf0\x23\x8d\xb1\xe5\x6c\x42",
b"\x8f\x3e\xe7\x74\x68\x11\x41\x36\x6c\x51\x6c\x37\x25\x29\x03\xf4\x23\xc8\x3e\xb3\x2f\xb0\x8a\x46\xb7\x2d\xdd\xda\x3d\x81\xb5\xf5",
b"\x0f\x9f\xfd\x34\x86\xc9\xd9\xe3\x50\xc0\xd4\xc9\x8a\x84\xce\x90\xc5\x82\x8f\x2e\x8b\xb4\x84\x5a\x7c\x2a\x4a\xb7\x5a\x62\xd8\x1c",
b"\x42\x4c\xf8\x9a\x80\xc4\xb7\x14\x77\xb2\x69\x44\xfc\xeb\x92\xd9\x0d\x3b\x20\x48\xbd\xca\x26\x06\x94\x80\x17\x55\xb1\xe3\x8f\xcf",
b"\x3a\x29\xc0\xf9\x3f\x75\x60\xb8\x25\xfe\x25\x5d\xa5\x19\x89\xbb\x44\xe0\x8c\xa6\x14\x8b\x7c\x06\x87\x79\xfd\xde\xee\x87\x6d\x70",
b"\x3a\xd5\x5d\x82\x30\x0e\xf8\x6e\x73\x9e\x76\xd4\x80\x6b\x5f\x3b\x6f\x19\x5f\xd9\x8d\x35\x82\x67\x9a\x98\xec\xf5\x56\xb7\x8f\x2a",
b"\x22\x3a\x85\xbf\x2b\x49\x01\x8b\xb9\x03\x7b\x8a\x50\x9e\xee\x76\x5a\x98\xff\xc7\x5e\xae\xeb\x3d\x3e\xd8\xf6\x4b\xb7\x97\x26\xac",
b"\xac\x43\x11\x33\x01\x74\x84\x44\x84\x3b\x9c\x66\xf9\x98\x94\xd2\x3a\x42\x5a\xb3\x3c\x61\xc1\xfd\x0c\x85\xc3\xdd\x5a\xf0\x5e\x49",
b"\x4a\x9d\xb2\xad\x91\xd1\x8b\x34\x7e\x72\x47\x6a\x5d\x33\xbc\x99\xbf\x90\xec\xa1\xaf\x3c\x65\xbf\xa3\x07\x32\x6c\x0d\x0b\xf7\x81",
b"\x05\x22\x78\x56\xc1\x68\xca\x03\xd2\x72\xe7\x7b\x61\x0f\x1a\x9c\xf8\x84\xe5\x78\xf7\x14\x47\x4d\xd2\x9a\x23\xc4\xa3\xb0\x15\x2e",
b"\x3c\x7d\xd2\x1f\xde\xd8\x96\xf7\x88\x71\x9b\x14\x42\xed\xed\x5b\x2d\x4c\x9d\xfa\x38\x96\xf5\x73\xb4\xc0\x1a\x38\x8e\x5d\xfe\xdc",
b"\x8a\x50\x4c\x95\x85\xfa\x04\x45\xaa\x26\xd2\x1e\xd5\xbc\xe5\x91\xe4\x42\xc6\x55\x9b\x50\x3c\x8f\x15\x69\x7b\xbe\x94\x7c\xd6\xa1",
b"\x4a\x9d\xb2\xad\x91\xd1\x8b\x34\x7e\x72\x47\x6a\x5d\x33\xbc\x99\xbf\x90\xec\xa1\xaf\x3c\x65\xbf\xa3\x07\x32\x6c\x0d\x0b\xf7\x81",
b"\x8b\xf4\x64\xf1\x19\x47\xc8\x91\x4a\x31\x85\xcf\x40\xdc\xbf\x95\xce\x30\xbd\x9e\x90\xbe\xf0\x87\xf8\x6b\x5f\x17\x5b\x55\x5a\xb6",
b"\x51\x28\x5f\x75\xff\xca\x5e\xf6\x9c\x73\x31\xd3\xf9\x0a\xbe\x84\x62\x8a\x37\x9e\x25\x74\x7f\x8d\x4b\xc8\x1f\xbc\x6e\x77\x07\xa2"
]


def hash(data):
    return hashlib.sha256(data).digest()


message2_hash = hash(b"Sign for flag")
data2 = [255 - b for b in message2_hash]

sig2 = []
for i in range(len(sig1)):
    tmp = sig1[0]
    for j in range(data2[i] + i):
        tmp = hash(tmp)
    sig2.append(tmp)

aes_key = bytes(s[0] for s in sig2)
flag = b"\x0d\x1f\xcc\xda\xb4\x60\x67\x0b\x32\xc3\x2f\xc6\x08\x06\xa0\x60\x6e\x01\xc1\x70\x7f\x2b\x28\x26\x47\xb5\x1f\x21\x26\xd8\xfd\x6f"
aes_iv = b'\x27\x1c\x15\x3f\xa0\x2b\xe8\x1b\x26\x85\x69\x0d\x81\x73\xc3\x6e'

cipher = AES.new(aes_key, AES.MODE_CBC, aes_iv)
print(cipher.decrypt(flag))
